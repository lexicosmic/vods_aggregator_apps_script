<script>
  // Ao carregar a página...
  document.addEventListener("DOMContentLoaded", function () {
    // Executa a função de carregar todos os elementos da página com os dados extraídos da planilha
    google.script.run.withSuccessHandler(carregarDados).getTableData();

    function carregarDados(tableData) {
      let tableBody = document.getElementById("vodsTableBody");

      tableData.forEach((vod) => {
        let row = tableBody.insertRow();
        row.id = vod.id;
        // Informações básicas
        row.insertCell().appendChild(document.createTextNode(vod.num));
        row.insertCell().appendChild(document.createTextNode(vod.sts));
        row.insertCell().appendChild(document.createTextNode(vod.tit));

        let link = document.createElement("a");
        link.setAttribute("href", "https://www.twitch.tv/videos/" + vod.cod);
        link.setAttribute("target", "_blank");
        link.setAttribute("rel", "noopener noreferrer");
        link.innerHTML = vod.cod;
        row.insertCell().appendChild(link);

        let nestedTable = document.createElement("table");

        // Conteúdo
        vod.contents.forEach((content) => {
          let contRow = nestedTable.insertRow();
          contRow.insertCell().appendChild(document.createTextNode(content[2]));
          contRow.insertCell().appendChild(document.createTextNode(content[3]));
          contRow.insertCell().appendChild(document.createTextNode(content[4]));
        });

        // Observações e participações
        if (vod.obs !== "") {
          let obsCell = nestedTable.insertRow().insertCell();
          let obsSpan = document.createElement("span");
          obsSpan.appendChild(document.createTextNode("Observações: "));
          obsCell.appendChild(obsSpan);
          obsCell.appendChild(document.createTextNode(vod.obs));
        }
        if (vod.part !== "") {
          let partCell = nestedTable.insertRow().insertCell();
          let partSpan = document.createElement("span");
          partSpan.appendChild(document.createTextNode("Participações: "));
          partCell.appendChild(partSpan);
          partCell.appendChild(document.createTextNode(vod.part));
        }

        let nestedRow = tableBody.insertRow();
        nestedRow.id = "n" + vod.id;
        nestedRow.appendChild(nestedTable);
      });
    }
  });
</script>
